(function(){var d,g,h,k,j=function(){};j.__name__=!0;j.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};j.substr=function(a,b,c){if(null!=b&&0!=b&&null!=c&&0>c)return"";null==c&&(c=a.length);0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b);return a.substr(b,c)};var i=function(){};i.__name__=!0;i.main=function(){try{i.checkJSScriptDepenencies()}catch(a){if(g.__instanceof(a,String)){h.trace("Error setting up - missing one or more JS script dependencies",{fileName:"Main.hx",lineNumber:55,
className:"Main",methodName:"main",customParams:["error"]});h.trace(a,{fileName:"Main.hx",lineNumber:56,className:"Main",methodName:"main",customParams:["error"]});return}throw a;}new $(function(){var a=i.getScriptSrcParameters("mbp_rectanglePacker"),c=i.getParameter("container",a,"div#rectContainer"),r=l.parseInt(i.getParameter("xCellSize",a)),e=l.parseInt(i.getParameter("yCellSize",a)),f=l.parseInt(i.getParameter("padX",a)),a=l.parseInt(i.getParameter("padY",a));new d.rectanglepacking.Packer(c,
r,e,f,a)})};i.checkJSScriptDepenencies=function(){"undefined"===typeof console&&(console={log:function(){},debug:function(){},warn:function(){},error:function(){},info:function(){}});var a=!1;if(a="undefined"===typeof window.jQuery)throw"jQuery not found";};i.getParameter=function(a,b,c){for(var d=0,e=b.length;d<e;){var f=d++;if(b[f].name==a)return b[f].value}return c};i.getScriptSrcParameters=function(a){for(var a=(new $("script[data*="+a+"]")).attr("src"),a=j.substr(a,a.indexOf("?")+1,null).split("&"),
b,c=[],d=0,e=a.length;d<e;){var f=d++;b=a[f].split("=");c[f]=new n(b[0],b[1])}return c};var n=function(a,b){this.name=a;this.value=b};n.__name__=!0;n.prototype={__class__:n};var l=function(){};l.__name__=!0;l.parseInt=function(a){var b=parseInt(a,10);if(0==b&&(120==j.cca(a,1)||88==j.cca(a,1)))b=parseInt(a);return isNaN(b)?null:b};l.parseFloat=function(a){return parseFloat(a)};k=h=void 0;h=function(){};h.__name__=!0;h.trace=function(a,b){g.__trace(a,b)};k=function(a){var b=this;this.id=setInterval(function(){b.run()},
a)};k.__name__=!0;k.delay=function(a,b){var c=new k(b);c.run=function(){c.stop();a()};return c};k.prototype={run:function(){h.trace("run",{fileName:"Timer.hx",lineNumber:98,className:"haxe.Timer",methodName:"run"})},stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},__class__:k};g=void 0;g=function(){};g.__name__=!0;g.__unhtml=function(a){return a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")};g.__trace=function(a,b){var c=null!=b?b.fileName+":"+b.lineNumber+
": ":"",c=c+g.__string_rec(a,"");if(null!=b&&null!=b.customParams)for(var d=0,e=b.customParams;d<e.length;){var f=e[d];++d;c+=","+g.__string_rec(f,"")}var h;"undefined"!=typeof document&&null!=(h=document.getElementById("haxe:trace"))?h.innerHTML+=g.__unhtml(c)+"<br/>":"undefined"!=typeof console&&null!=console.log&&console.log(c)};g.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;if("function"==c&&(a.__name__||a.__ename__))c="object";switch(c){case "object":if(a instanceof
Array){if(a.__enum__){if(2==a.length)return a[0];for(var c=a[0]+"(",b=b+"\t",d=2,e=a.length;d<e;)var f=d++,c=2!=f?c+(","+g.__string_rec(a[f],b)):c+g.__string_rec(a[f],b);return c+")"}d=a.length;c="[";b+="\t";for(e=0;e<d;)f=e++,c+=(0<f?",":"")+g.__string_rec(a[f],b);return c+"]"}try{e=a.toString}catch(h){return"???"}if(null!=e&&e!=Object.toString&&(c=a.toString(),"[object Object]"!=c))return c;e=null;c="{\n";b+="\t";d=null!=a.hasOwnProperty;for(e in a)if(!d||a.hasOwnProperty(e))"prototype"==e||("__class__"==
e||"__super__"==e||"__interfaces__"==e||"__properties__"==e)||(2!=c.length&&(c+=", \n"),c+=b+e+" : "+g.__string_rec(a[e],b));b=b.substring(1);return c+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return""+a}};g.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,f=c[f];if(f==b||g.__interfLoop(f,b))return!0}return g.__interfLoop(a.__super__,b)};g.__instanceof=function(a,b){if(null==
b)return!1;switch(b){case s:return(a|0)===a;case p:return"number"==typeof a;case q:return"boolean"==typeof a;case String:return"string"==typeof a;case t:return!0;default:if(null!=a){if("function"==typeof b){if(a instanceof b)return b==Array?null==a.__enum__:!0;if(g.__interfLoop(a.__class__,b))return!0}}else return!1;return b==u&&null!=a.__name__||b==v&&null!=a.__ename__?!0:a.__enum__==b}};d=void 0;d={rectanglepacking:{}};d.rectanglepacking.Packer=function(a,b,c,g,e){null==e&&(e=8);null==g&&(g=8);
null==c&&(c=8);null==b&&(b=8);var f=this;this.xCellSize=b;this.yCellSize=c;this.padX=g;this.padY=e;1>b&&(b=1);1>c&&(c=1);this.tempPt=new d.rectanglepacking.geom.Point;this.container=new $(a);this.outerBounds=d.rectanglepacking.Packer.getDomElementBounds(this.container[0]);this.fixedElements=new $(a+" div.fixedElement");this.packableElements=new $(a+" div.packableElement");this.packables=[];this.packableElements.each(function(a,b){f.packables.push(new d.rectanglepacking.Packable(a,b))});this.fixedPositions=
[];this.fixedElements.each(function(a,b){f.fixedPositions[a]=d.rectanglepacking.Packer.getDomElementBounds(b)});this.packableElements.css("display","none");this.prepare();this.fixedElements.remove();0<this.packables.length?this.packItem(0):h.trace("Nothing to pack...?",{fileName:"Packer.hx",lineNumber:122,className:"madebypi.util.rectanglepacking.Packer",methodName:"new",customParams:["warn"]})};d.rectanglepacking.Packer.__name__=!0;d.rectanglepacking.Packer.getDomElementBounds=function(a){var a=
new $(a),b=l.parseFloat(a.css("top")),c=l.parseFloat(a.css("left"));Math.isNaN(b)&&(b=0);Math.isNaN(c)&&(c=0);return new d.rectanglepacking.geom.Rectangle(c,b,a.width(),a.height())};d.rectanglepacking.Packer.prototype={sortPackableItemsByArea:function(){for(var a=[],b=this.packables.length,c=0;c<b;){var d=c++;a.push({index:d,area:this.packables[d].rect.get_area()})}a.sort(function(a,b){return a.area>b.area?-1:a.area<b.area?1:0});this.areaSortedIndices=[];for(c=0;c<b;)d=c++,this.areaSortedIndices[d]=
a[d].index},findSpace:function(a,b){b.inflate(this.padX,this.padY);for(var c=Math.round(this.outerBounds.width/this.xCellSize),g=Math.round(this.outerBounds.height/this.yCellSize),e=0,f=0,i=0,f=0,l=this.fixedPositions.length,k=!1,j=this.outerBounds.width*this.outerBounds.height,e=!1,o=new d.rectanglepacking.geom.Rectangle,m,j=j*j,n=0;n<c;){i=n++*this.xCellSize;b.x=i;for(var p=0;p<g;){f=p++;e=!1;f*=this.yCellSize;b.y=f;if(b.get_bottom()<=this.outerBounds.get_bottom())for(var q=0;q<l;)m=this.fixedPositions[q++],
e=e||((m.get_right()>b.get_right()?b.get_right():m.get_right())<=(m.x<b.x?b.x:m.x)?!1:(m.get_bottom()>b.get_bottom()?b.get_bottom():m.get_bottom())>(m.y<b.y?b.y:m.y));else e=!0;e||(k=!0,this.tempPt.x=i,this.tempPt.y=f,e=a.x-this.tempPt.x,f=a.y-this.tempPt.y,e=e*e+f*f,e<j&&(j=e,o.x=b.x,o.y=b.y,o.width=b.width,o.height=b.height))}}if(!k)return h.trace("I'm sorry, I can't place that Dave.",{fileName:"Packer.hx",lineNumber:289,className:"madebypi.util.rectanglepacking.Packer",methodName:"findSpace"}),
null;o.inflate(-this.padX,-this.padY);return o},packComplete:function(){h.trace("Packing completed!",{fileName:"Packer.hx",lineNumber:212,className:"madebypi.util.rectanglepacking.Packer",methodName:"packComplete",customParams:["info"]});for(var a=0,b=0,c=this.packables.length;b<c;)this.packables[b++].packed&&a++;h.trace("Packed "+a+" of a possible "+this.packables.length+" rectangles",{fileName:"Packer.hx",lineNumber:216,className:"madebypi.util.rectanglepacking.Packer",methodName:"packComplete",
customParams:["info"]})},packItem:function(a){var b=this,c=null,g=(new Date).getTime(),e=this.packables[this.areaSortedIndices[a]];!e.packed&&!e.unpackable&&(c=this.findSpace(this.targetPoint,e.rect.clone()),null==c?(h.trace("Out of space! Can't place item "+e.index+" "+(new $(e.element)).html(),{fileName:"Packer.hx",lineNumber:172,className:"madebypi.util.rectanglepacking.Packer",methodName:"packItem",customParams:["info"]}),e.unpackable=!0,(new $(e.element)).remove()):(h.trace("Placing item "+e.index+
" at "+c.toString(),{fileName:"Packer.hx",lineNumber:178,className:"madebypi.util.rectanglepacking.Packer",methodName:"packItem"}),e.packed=!0,this.fixedPositions.push(c),(new $(e.element)).css("left",c.x).css("top",c.y).css("display","block").removeClass("packableElement").addClass("packedElement")));c=(new Date).getTime()-g;h.trace("Took "+c+"ms to pack rect",{fileName:"Packer.hx",lineNumber:193,className:"madebypi.util.rectanglepacking.Packer",methodName:"packItem"});a++;a==this.packables.length?
this.packComplete():c>d.rectanglepacking.Packer.MAX_PACK_TIME?k.delay(function(){b.packItem(a)},d.rectanglepacking.Packer.MAX_PACK_TIME):this.packItem(a)},prepare:function(){var a=new $("div#fixed-master.fixedElement");0==a.length?(h.trace("#fixed-master not found in .fixedElement items. Using the container instead...",{fileName:"Packer.hx",lineNumber:137,className:"madebypi.util.rectanglepacking.Packer",methodName:"prepare",customParams:["info"]}),a=this.outerBounds.clone()):a=d.rectanglepacking.Packer.getDomElementBounds(a[0]);
this.sortPackableItemsByArea();this.targetPoint=new d.rectanglepacking.geom.Point(a.x+a.width/2,a.y+a.height/2)},__class__:d.rectanglepacking.Packer};d.rectanglepacking.Packable=function(a,b){this.packed=this.unpackable=!1;this.element=b;this.index=a;this.rect=d.rectanglepacking.Packer.getDomElementBounds(b);(new $(b)).attr("id","packable_"+a)};d.rectanglepacking.Packable.__name__=!0;d.rectanglepacking.Packable.prototype={__class__:d.rectanglepacking.Packable};d.rectanglepacking.geom={};d.rectanglepacking.geom.Point=
function(a,b){this.x=null==a?0:a;this.y=null==b?0:b};d.rectanglepacking.geom.Point.__name__=!0;d.rectanglepacking.geom.Point.prototype={clone:function(){return new d.rectanglepacking.geom.Point(this.x,this.y)},__class__:d.rectanglepacking.geom.Point};d.rectanglepacking.geom.Rectangle=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.width=c;this.height=d};d.rectanglepacking.geom.Rectangle.__name__=!0;d.rectanglepacking.geom.Rectangle.intersects=function(a,
b){return(a.get_right()>b.get_right()?b.get_right():a.get_right())<=(a.x<b.x?b.x:a.x)?!1:(a.get_bottom()>b.get_bottom()?b.get_bottom():a.get_bottom())>(a.y<b.y?b.y:a.y)};d.rectanglepacking.geom.Rectangle.prototype={inflate:function(a,b){this.x-=a;this.width+=2*a;this.y-=b;this.height+=2*b},clone:function(){return new d.rectanglepacking.geom.Rectangle(this.x,this.y,this.width,this.height)},get_bottomRight:function(){return new d.rectanglepacking.geom.Point(this.x+this.width,this.y+this.height)},get_size:function(){return new d.rectanglepacking.geom.Point(this.width,
this.height)},get_topLeft:function(){return new d.rectanglepacking.geom.Point(this.x,this.y)},get_bottom:function(){return this.y+this.height},get_top:function(){return this.y},get_right:function(){return this.x+this.width},get_left:function(){return this.x},get_area:function(){return this.width*this.height},toString:function(){return"[Rectangle x:"+this.x+", y:"+this.y+", w:"+this.width+", h:"+this.height+"]"},__class__:d.rectanglepacking.geom.Rectangle};Math.__name__=["Math"];Math.NaN=Number.NaN;
Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;Math.isFinite=function(a){return isFinite(a)};Math.isNaN=function(a){return isNaN(a)};String.prototype.__class__=String;String.__name__=!0;Array.prototype.__class__=Array;Array.__name__=!0;Date.prototype.__class__=Date;Date.__name__=["Date"];var s={__name__:["Int"]},t={__name__:["Dynamic"]},p=Number;p.__name__=["Float"];var q=Boolean;q.__ename__=["Bool"];var u={__name__:["Class"]},v={};i.isDebug=!1;d.rectanglepacking.Packer.MAX_PACK_TIME=
40;i.main()})();
